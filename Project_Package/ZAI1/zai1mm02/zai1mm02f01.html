<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="application/xhtml+xml; EUC-KR" />
<title>ZAI1MM02F01</title>
<style type="text/css">
.code{ font-family:"Courier New", Courier, monospace; color:#000; font-size:14px; background-color:#F2F4F7 }
  .codeComment {font-family:"Courier New", Courier, monospace; color:#0000F0; font-size:14px; background-color:#F2F4F7 }
  .normalBold{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px; font-weight:800 }
  .normalBoldLarge{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:16px; font-weight:800 }
</style>
<style type="text/css">
  .normal{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px }
  .footer{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px; text-align: center }
  h2{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:16px; font-weight:800 }
  h3{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:14px; font-weight:800 }
  .outerTable{
   background-color:#E0E7ED;
   width:100%;
   border-top-width: thin;
   border-right-width: thin;
   border-right-width: thin;
   border-left-width: thin;
   border-top-style: solid;
   border-right-style: solid;
   border-bottom-style: solid;
   border-left-style: solid;
  }
  .innerTable{
   background-color:#F2F4F7;
   width:100%;
   border-top-width: thin;
   border-right-width: thin;
   border-bottom-width: thin;
   border-left-width: thin;
   border-top-style: solid;
   border-right-style: solid;
   border-bottom-style: solid;
   border-left-style: solid;
  }
</style>
</head>
<body>
<table class="outerTable">
  <tr class="normalBoldLarge">
     <td><h2>Code listing for: ZAI1MM02F01</h2>
<h3> Description: Include ZAI01R0001F01</h3></td>
   </tr>
  <tr>
     <td>
     <table class="innerTable">
       <tr>
          <td>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;FORM&nbsp;CREATE_OBJECT<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;TEXT<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;P1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT<br />
*&&nbsp;&lt;--&nbsp;&nbsp;P2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM create_object .<br />
<br />
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;go_docking<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIDE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GO-DOCKING-&gt;DOCK_AT_LEFT<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;side&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;cl_gui_docking_container=&gt;dock_at_right<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;extension&nbsp;=&nbsp;cl_gui_docking_container=&gt;ws_maximizebox.<br />
<br />
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;go_grid<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_parent&nbsp;=&nbsp;go_docking.<br />
<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;FORM&nbsp;SET_FIELDCAT<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;TEXT<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;P1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT<br />
*&&nbsp;&lt;--&nbsp;&nbsp;P2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM set_fieldcat .<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gt_fieldcat.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fieldcat.<br />
&nbsp;&nbsp;gs_fieldcat-fieldname&nbsp;=&nbsp;'ICON'.<br />
&nbsp;&nbsp;gs_fieldcat-coltext&nbsp;=&nbsp;'##'.<br />
&nbsp;&nbsp;gs_fieldcat-key&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;gs_fieldcat-just&nbsp;&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;gs_fieldcat-ref_table&nbsp;=&nbsp;'ICON'.<br />
&nbsp;&nbsp;gs_fieldcat-col_opt&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fieldcat&nbsp;TO&nbsp;gt_fieldcat.<br />
<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fieldcat.<br />
&nbsp;&nbsp;gs_fieldcat-fieldname&nbsp;=&nbsp;'EBELN'.<br />
&nbsp;&nbsp;gs_fieldcat-coltext&nbsp;=&nbsp;'####'.<br />
&nbsp;&nbsp;gs_fieldcat-key&nbsp;=&nbsp;'X'.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;GS_FIELDCAT-EDIT&nbsp;=&nbsp;GV_EDIT.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;gs_fieldcat-ref_table&nbsp;=&nbsp;'EKPO'.<br />
&nbsp;&nbsp;gs_fieldcat-col_opt&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fieldcat&nbsp;TO&nbsp;gt_fieldcat.<br />
<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fieldcat.<br />
&nbsp;&nbsp;gs_fieldcat-fieldname&nbsp;=&nbsp;'INVDAT'.<br />
&nbsp;&nbsp;gs_fieldcat-coltext&nbsp;=&nbsp;'####'.<br />
&nbsp;&nbsp;gs_fieldcat-just&nbsp;=&nbsp;'L'.<br />
&nbsp;&nbsp;gs_fieldcat-edit&nbsp;=&nbsp;gv_edit.<br />
&nbsp;&nbsp;gs_fieldcat-col_opt&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fieldcat&nbsp;TO&nbsp;gt_fieldcat.<br />
<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fieldcat.<br />
&nbsp;&nbsp;gs_fieldcat-fieldname&nbsp;=&nbsp;'STCEG'.<br />
&nbsp;&nbsp;gs_fieldcat-coltext&nbsp;=&nbsp;'#####'.<br />
&nbsp;&nbsp;gs_fieldcat-ref_table&nbsp;=&nbsp;'LFA1'.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;GS_FIELDCAT-EDIT&nbsp;=&nbsp;GV_EDIT.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;gs_fieldcat-col_opt&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fieldcat&nbsp;TO&nbsp;gt_fieldcat.<br />
<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fieldcat.<br />
&nbsp;&nbsp;gs_fieldcat-fieldname&nbsp;=&nbsp;'NAME1'.<br />
&nbsp;&nbsp;gs_fieldcat-coltext&nbsp;=&nbsp;'###'.<br />
&nbsp;&nbsp;gs_fieldcat-ref_table&nbsp;=&nbsp;'LFA1'.<br />
&nbsp;&nbsp;gs_fieldcat-edit&nbsp;=&nbsp;gv_edit.<br />
&nbsp;&nbsp;gs_fieldcat-col_opt&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fieldcat&nbsp;TO&nbsp;gt_fieldcat.<br />
<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fieldcat.<br />
&nbsp;&nbsp;gs_fieldcat-fieldname&nbsp;=&nbsp;'LIFNR'.<br />
&nbsp;&nbsp;gs_fieldcat-coltext&nbsp;=&nbsp;'####'.<br />
&nbsp;&nbsp;gs_fieldcat-ref_table&nbsp;=&nbsp;'LFA1'.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;GS_FIELDCAT-EDIT&nbsp;=&nbsp;GV_EDIT.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;gs_fieldcat-col_opt&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fieldcat&nbsp;TO&nbsp;gt_fieldcat.<br />
<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fieldcat.<br />
&nbsp;&nbsp;gs_fieldcat-fieldname&nbsp;=&nbsp;'MATNR'.<br />
&nbsp;&nbsp;gs_fieldcat-coltext&nbsp;=&nbsp;'##'.<br />
&nbsp;&nbsp;gs_fieldcat-ref_table&nbsp;=&nbsp;'EKPO'.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;GS_FIELDCAT-EDIT&nbsp;=&nbsp;GV_EDIT.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;gs_fieldcat-col_opt&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fieldcat&nbsp;TO&nbsp;gt_fieldcat.<br />
<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fieldcat.<br />
&nbsp;&nbsp;gs_fieldcat-fieldname&nbsp;=&nbsp;'TXZ01'.<br />
&nbsp;&nbsp;gs_fieldcat-coltext&nbsp;=&nbsp;'##'.<br />
&nbsp;&nbsp;gs_fieldcat-ref_table&nbsp;=&nbsp;'EKPO'.<br />
&nbsp;&nbsp;gs_fieldcat-edit&nbsp;=&nbsp;gv_edit.<br />
&nbsp;&nbsp;gs_fieldcat-col_opt&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fieldcat&nbsp;TO&nbsp;gt_fieldcat.<br />
<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fieldcat.<br />
&nbsp;&nbsp;gs_fieldcat-fieldname&nbsp;=&nbsp;'MENGE'.<br />
&nbsp;&nbsp;gs_fieldcat-coltext&nbsp;=&nbsp;'##'.<br />
&nbsp;&nbsp;gs_fieldcat-ref_table&nbsp;=&nbsp;'EKPO'.<br />
&nbsp;&nbsp;gs_fieldcat-emphasize&nbsp;=&nbsp;'C300'.<br />
&nbsp;&nbsp;gs_fieldcat-qfieldname&nbsp;=&nbsp;'MEINS'.<br />
&nbsp;&nbsp;gs_fieldcat-do_sum&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;gs_fieldcat-col_opt&nbsp;=&nbsp;'X'.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;GS_FIELDCAT-EDIT&nbsp;=&nbsp;GV_EDIT.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;APPEND&nbsp;gs_fieldcat&nbsp;TO&nbsp;gt_fieldcat.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fieldcat.<br />
&nbsp;&nbsp;gs_fieldcat-fieldname&nbsp;=&nbsp;'MEINS'.<br />
&nbsp;&nbsp;gs_fieldcat-coltext&nbsp;=&nbsp;'##'.<br />
&nbsp;&nbsp;gs_fieldcat-just&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;gs_fieldcat-col_opt&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;gs_fieldcat-convexit&nbsp;=&nbsp;'CUNIT'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fieldcat&nbsp;TO&nbsp;gt_fieldcat.<br />
<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fieldcat.<br />
&nbsp;&nbsp;gs_fieldcat-fieldname&nbsp;=&nbsp;'NETPR'.<br />
&nbsp;&nbsp;gs_fieldcat-coltext&nbsp;=&nbsp;'##'.<br />
&nbsp;&nbsp;gs_fieldcat-just&nbsp;&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;gs_fieldcat-ref_table&nbsp;=&nbsp;'EKPO'.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;GS_FIELDCAT-EDIT&nbsp;=&nbsp;GV_EDIT.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;gs_fieldcat-emphasize&nbsp;=&nbsp;'C300'.<br />
&nbsp;&nbsp;gs_fieldcat-just&nbsp;=&nbsp;'R'.<br />
&nbsp;&nbsp;gs_fieldcat-col_opt&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fieldcat&nbsp;TO&nbsp;gt_fieldcat.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fieldcat.<br />
&nbsp;&nbsp;gs_fieldcat-fieldname&nbsp;=&nbsp;'NETWR'.<br />
&nbsp;&nbsp;gs_fieldcat-coltext&nbsp;=&nbsp;'####'.<br />
&nbsp;&nbsp;gs_fieldcat-ref_table&nbsp;=&nbsp;'EKPO'.<br />
&nbsp;&nbsp;gs_fieldcat-cfieldname&nbsp;=&nbsp;'WAERS'.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;GS_FIELDCAT-EDIT&nbsp;=&nbsp;GV_EDIT.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;gs_fieldcat-emphasize&nbsp;=&nbsp;'C500'.<br />
&nbsp;&nbsp;gs_fieldcat-just&nbsp;=&nbsp;'R'.<br />
&nbsp;&nbsp;gs_fieldcat-col_opt&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;gs_fieldcat-do_sum&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fieldcat&nbsp;TO&nbsp;gt_fieldcat.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fieldcat.<br />
&nbsp;&nbsp;gs_fieldcat-fieldname&nbsp;=&nbsp;'BRTWR'.<br />
&nbsp;&nbsp;gs_fieldcat-coltext&nbsp;=&nbsp;'#####'.<br />
&nbsp;&nbsp;gs_fieldcat-ref_table&nbsp;=&nbsp;'EKPO'.<br />
&nbsp;&nbsp;gs_fieldcat-cfieldname&nbsp;=&nbsp;'WAERS'.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;GS_FIELDCAT-EDIT&nbsp;=&nbsp;GV_EDIT.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;gs_fieldcat-emphasize&nbsp;=&nbsp;'C500'.<br />
&nbsp;&nbsp;gs_fieldcat-just&nbsp;=&nbsp;'R'.<br />
&nbsp;&nbsp;gs_fieldcat-col_opt&nbsp;=&nbsp;'X'.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;GS_FIELDCAT-DO_SUM&nbsp;=&nbsp;'C'.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;APPEND&nbsp;gs_fieldcat&nbsp;TO&nbsp;gt_fieldcat.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fieldcat.<br />
&nbsp;&nbsp;gs_fieldcat-fieldname&nbsp;=&nbsp;'MWSKZ'.<br />
&nbsp;&nbsp;gs_fieldcat-coltext&nbsp;=&nbsp;'##'.<br />
&nbsp;&nbsp;gs_fieldcat-ref_table&nbsp;=&nbsp;'RSEG'.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;GS_FIELDCAT-EDIT&nbsp;=&nbsp;GV_EDIT.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;gs_fieldcat-cfieldname&nbsp;=&nbsp;'WAERS'.<br />
&nbsp;&nbsp;gs_fieldcat-emphasize&nbsp;=&nbsp;'C700'.<br />
&nbsp;&nbsp;gs_fieldcat-col_opt&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fieldcat&nbsp;TO&nbsp;gt_fieldcat.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fieldcat.<br />
&nbsp;&nbsp;gs_fieldcat-fieldname&nbsp;=&nbsp;'RBWWR'.<br />
&nbsp;&nbsp;gs_fieldcat-coltext&nbsp;=&nbsp;'####'.<br />
&nbsp;&nbsp;gs_fieldcat-ref_table&nbsp;=&nbsp;'RSEG'.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;GS_FIELDCAT-EDIT&nbsp;=&nbsp;GV_EDIT.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;gs_fieldcat-emphasize&nbsp;=&nbsp;'C500'.<br />
&nbsp;&nbsp;gs_fieldcat-just&nbsp;=&nbsp;'R'.<br />
&nbsp;&nbsp;gs_fieldcat-col_opt&nbsp;=&nbsp;'X'.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;GS_FIELDCAT-DO_SUM&nbsp;=&nbsp;'C'.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;APPEND&nbsp;gs_fieldcat&nbsp;TO&nbsp;gt_fieldcat.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fieldcat.<br />
&nbsp;&nbsp;gs_fieldcat-fieldname&nbsp;=&nbsp;'WAERS'.<br />
&nbsp;&nbsp;gs_fieldcat-coltext&nbsp;=&nbsp;'##'.<br />
&nbsp;&nbsp;gs_fieldcat-ref_table&nbsp;=&nbsp;'EKKO'.<br />
&nbsp;&nbsp;gs_fieldcat-col_opt&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fieldcat&nbsp;TO&nbsp;gt_fieldcat.<br />
<br />
&nbsp;&nbsp;gs_fieldcat-fieldname&nbsp;=&nbsp;'ATTACH'.<br />
&nbsp;&nbsp;gs_fieldcat-coltext&nbsp;=&nbsp;'##'.<br />
&nbsp;&nbsp;gs_fieldcat-just&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;gs_fieldcat-hotspot&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;gs_fieldcat-col_opt&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fieldcat&nbsp;TO&nbsp;gt_fieldcat.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fieldcat.<br />
&nbsp;&nbsp;gs_fieldcat-fieldname&nbsp;=&nbsp;'BELNR'.<br />
&nbsp;&nbsp;gs_fieldcat-coltext&nbsp;=&nbsp;'####'.<br />
&nbsp;&nbsp;gs_fieldcat-ref_table&nbsp;=&nbsp;'RBKP'.<br />
&nbsp;&nbsp;gs_fieldcat-col_opt&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;gs_fieldcat-emphasize&nbsp;=&nbsp;'C700'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fieldcat&nbsp;TO&nbsp;gt_fieldcat.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fieldcat.<br />
&nbsp;&nbsp;gs_fieldcat-fieldname&nbsp;=&nbsp;'MESSAGE'.<br />
&nbsp;&nbsp;gs_fieldcat-coltext&nbsp;=&nbsp;'###'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fieldcat&nbsp;TO&nbsp;gt_fieldcat.<br />
<br />
<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;FORM&nbsp;SET_LAYOUT<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;TEXT<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;P1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT<br />
*&&nbsp;&lt;--&nbsp;&nbsp;P2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM set_layout .<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_layout.<br />
&nbsp;&nbsp;gs_layout-grid_title&nbsp;&nbsp;&nbsp;=&nbsp;gv_grid_title.<br />
&nbsp;&nbsp;gs_layout-zebra&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;gs_layout-sel_mode&nbsp;&nbsp;&nbsp;=&nbsp;'B'.<br />
&nbsp;&nbsp;gs_layout-cwidth_opt&nbsp;=&nbsp;'A'.<br />
&nbsp;&nbsp;gs_layout-stylefname&nbsp;&nbsp;=&nbsp;'STYLE'.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;FORM&nbsp;SET_SORT<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;TEXT<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;P1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT<br />
*&&nbsp;&lt;--&nbsp;&nbsp;P2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM set_sort .<br />
<br />
<br />
&nbsp;&nbsp;CLEAR:&nbsp;gs_sort,&nbsp;gt_sort.<br />
<br />
&nbsp;&nbsp;gs_sort-fieldname&nbsp;=&nbsp;'EBELN'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_sort&nbsp;TO&nbsp;gt_sort.<br />
<br />
&nbsp;&nbsp;gs_sort-fieldname&nbsp;=&nbsp;'STCEG'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_sort&nbsp;TO&nbsp;gt_sort.<br />
<br />
&nbsp;&nbsp;gs_sort-fieldname&nbsp;=&nbsp;'NAME1'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_sort&nbsp;TO&nbsp;gt_sort.<br />
<br />
&nbsp;&nbsp;gs_sort-fieldname&nbsp;=&nbsp;'LIFNR'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_sort&nbsp;TO&nbsp;gt_sort.<br />
<br />
&nbsp;&nbsp;gs_sort-fieldname&nbsp;=&nbsp;'INVDAT'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_sort&nbsp;TO&nbsp;gt_sort.<br />
<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;FORM&nbsp;SET_EVENT<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;TEXT<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;P1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT<br />
*&&nbsp;&lt;--&nbsp;&nbsp;P2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM set_event .<br />
<br />
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;go_event_receiver.<br />
<br />
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;:&nbsp;go_event_receiver-&gt;handle_hotspot_click&nbsp;FOR&nbsp;go_grid,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;go_event_receiver-&gt;handle_toolbar&nbsp;FOR&nbsp;go_grid.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;go_grid-&gt;register_edit_event<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_event_id&nbsp;=&nbsp;go_grid-&gt;mc_evt_modified.<br />
<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;FORM&nbsp;DISPLAY_ALV<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;TEXT<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;P1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT<br />
*&&nbsp;&lt;--&nbsp;&nbsp;P2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM display_alv .<br />
<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;go_grid-&gt;set_table_for_first_display<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_BUFFER_ACTIVE&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_BYPASSING_BUFFER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_CONSISTENCY_CHECK&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_STRUCTURE_NAME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS_VARIANT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_SAVE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_DEFAULT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is_layout&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_layout<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS_PRINT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_SPECIAL_GROUPS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_TOOLBAR_EXCLUDING&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_HYPERLINK&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_ALV_GRAPHICS&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_EXCEPT_QINFO&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IR_SALV_ADAPTER&nbsp;=<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;CHANGING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it_outtab&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gt_data<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it_fieldcatalog&nbsp;=&nbsp;gt_fieldcat<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it_sort&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gt_sort<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_FILTER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;EXCEPTIONS<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INVALID_PARAMETER_COMBINATION&nbsp;=&nbsp;1<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PROGRAM_ERROR&nbsp;&nbsp;&nbsp;=&nbsp;2<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TOO_MANY_LINES&nbsp;&nbsp;=&nbsp;3<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;4<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;.<br />
<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;FORM&nbsp;REFRESH_ALV<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;TEXT<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;P1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT<br />
*&&nbsp;&lt;--&nbsp;&nbsp;P2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM refresh_alv .<br />
<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;go_grid-&gt;refresh_table_display.<br />
<br />
&nbsp;&nbsp;IF&nbsp;gv_saved&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;go_grid-&gt;set_ready_for_input<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_ready_for_input&nbsp;=&nbsp;0.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;##&nbsp;##&nbsp;#&nbsp;##&nbsp;##&nbsp;###<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;FORM&nbsp;GET_DATA<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;TEXT<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;P1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT<br />
*&&nbsp;&lt;--&nbsp;&nbsp;P2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM get_data .<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;SCREEN.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;'X'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;p_rb2_1.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;:&nbsp;gt_data2,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_data2.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;*<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;z01t0010<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;gt_data2<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;ernam&nbsp;IN&nbsp;s_ernam<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;ebeln&nbsp;IN&nbsp;s_ebeln<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;belnr&nbsp;IN&nbsp;s_belnr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;name1&nbsp;IN&nbsp;s_name1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;matnr&nbsp;IN&nbsp;s_matnr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;ivdat&nbsp;IN&nbsp;s_invdat<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;crtyn&nbsp;&lt;&gt;&nbsp;'X'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;p_rb2_2.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;:&nbsp;gt_data2,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gt_data2.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;*<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;z01t0010<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;gt_data2<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;ernam&nbsp;IN&nbsp;s_ernam<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;ebeln&nbsp;IN&nbsp;s_ebeln<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;belnr&nbsp;IN&nbsp;s_belnr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;name1&nbsp;IN&nbsp;s_name1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;matnr&nbsp;IN&nbsp;s_matnr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;ivdat&nbsp;IN&nbsp;s_invdat.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDCASE.<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;INCLUDE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZAI01R0001F01<br />
*&---------------------------------------------------------------------*<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;FORM&nbsp;GET_FILE<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;TEXT<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;P1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT<br />
*&&nbsp;&lt;--&nbsp;&nbsp;P2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM get_file .<br />
<br />
&nbsp;&nbsp;DATA&nbsp;:&nbsp;lt_path&nbsp;TYPE&nbsp;filetable,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_path&nbsp;TYPE&nbsp;file_table.<br />
<br />
&nbsp;&nbsp;DATA&nbsp;lv_rc&nbsp;TYPE&nbsp;i.<br />
<br />
   </div>
   <div class="codeComment">
*##&nbsp;###&nbsp;##<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;cl_gui_frontend_services=&gt;file_open_dialog<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WINDOW_TITLE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEFAULT_EXTENSION&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEFAULT_FILENAME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FILE_FILTER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH_ENCODING&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INITIAL_DIRECTORY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MULTISELECTION&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;CHANGING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file_table&nbsp;=&nbsp;lt_path<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rc&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lv_rc<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USER_ACTION<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FILE_ENCODING&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FILE_OPEN_DIALOG_FAILED&nbsp;=&nbsp;1<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CNTL_ERROR&nbsp;=&nbsp;2<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ERROR_NO_GUI&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;3<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NOT_SUPPORTED_BY_GUI&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;4<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;5<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;.<br />
&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;IMPLEMENT&nbsp;SUITABLE&nbsp;ERROR&nbsp;HANDLING&nbsp;HERE<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;lt_path&nbsp;INTO&nbsp;ls_path&nbsp;INDEX&nbsp;1.<br />
&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;p_path&nbsp;=&nbsp;ls_path.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;FORM&nbsp;UPLOAD_DATA<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;TEXT<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;P1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT<br />
*&&nbsp;&lt;--&nbsp;&nbsp;P2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM upload_data .<br />
<br />
&nbsp;&nbsp;DATA&nbsp;:lt_intern&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;alsmex_tabline,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_intern&nbsp;TYPE&nbsp;alsmex_tabline.<br />
<br />
<br />
&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'ALSM_EXCEL_TO_INTERNAL_TABLE'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filename&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;p_path<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_begin_col&nbsp;=&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_begin_row&nbsp;=&nbsp;2<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_end_col&nbsp;&nbsp;&nbsp;=&nbsp;16<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_end_row&nbsp;&nbsp;&nbsp;=&nbsp;9999<br />
&nbsp;&nbsp;&nbsp;&nbsp;TABLES<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;intern&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lt_intern.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gt_excel.<br />
<br />
<br />
&nbsp;&nbsp;FIELD-SYMBOLS&nbsp;&lt;fs&gt;.<br />
&nbsp;&nbsp;CLEAR&nbsp;gt_excel.<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;lt_intern&nbsp;INTO&nbsp;ls_intern.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ASSIGN&nbsp;COMPONENT&nbsp;ls_intern-col&nbsp;OF&nbsp;STRUCTURE&nbsp;gs_excel&nbsp;TO&nbsp;&lt;fs&gt;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&lt;fs&gt;&nbsp;=&nbsp;ls_intern-value.<br />
&nbsp;&nbsp;&nbsp;&nbsp;AT&nbsp;END&nbsp;OF&nbsp;row.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;gs_excel&nbsp;TO&nbsp;gt_excel.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;gs_excel.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDAT.<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;FORM&nbsp;BUILD_DATA<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;TEXT<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;P1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT<br />
*&&nbsp;&lt;--&nbsp;&nbsp;P2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM build_data .<br />
<br />
&nbsp;&nbsp;DATA&nbsp;:&nbsp;lv_ebelp&nbsp;&nbsp;&nbsp;TYPE&nbsp;ekpo-ebelp,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_cnt&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;rseg-buzei,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_ebeln&nbsp;&nbsp;&nbsp;TYPE&nbsp;ekpo-ebeln,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_object&nbsp;&nbsp;TYPE&nbsp;sibflporb,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lt_objects&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;sibflporb,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_subrc&nbsp;&nbsp;&nbsp;TYPE&nbsp;sy-subrc.<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;gt_excel&nbsp;INTO&nbsp;gs_excel.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;gs_data.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_data-icon&nbsp;=&nbsp;icon_led_yellow.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-ATTACH&nbsp;=&nbsp;ICON_FOLDER&nbsp;&nbsp;.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;gs_data-invdat&nbsp;=&nbsp;gs_excel-invdat.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_data-matnr&nbsp;=&nbsp;gs_excel-matnr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_data-txz01&nbsp;=&nbsp;gs_excel-txz01.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_excel-erdat&nbsp;=&nbsp;sy-datum.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_excel-erzet&nbsp;=&nbsp;sy-uzeit.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_excel-ernam&nbsp;=&nbsp;sy-uname.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_excel-mwskz&nbsp;=&nbsp;'V3'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;gs_excel&nbsp;TO&nbsp;gs_data.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;chk_attach&nbsp;TABLES&nbsp;lt_objects<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USING&nbsp;gs_data-ebeln&nbsp;ls_object&nbsp;lv_subrc.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;lv_subrc&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_data-attach&nbsp;=&nbsp;icon_attachment.&nbsp;"##&nbsp;####<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_data-attach&nbsp;=&nbsp;icon_closed_folder.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;check_invdat&nbsp;USING&nbsp;gs_excel-invdat<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;gs_data.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;ebelp&nbsp;FROM&nbsp;ekpo<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;lv_ebelp<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;ebeln&nbsp;=&nbsp;gs_data-ebeln<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;elikz&nbsp;=&nbsp;'X'<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;matnr&nbsp;=&nbsp;gs_data-matnr.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;lv_ebeln&nbsp;=&nbsp;gs_excel-ebeln.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_data-buzei&nbsp;=&nbsp;lv_cnt&nbsp;+&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_cnt&nbsp;=&nbsp;lv_cnt&nbsp;+&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;COUNT(*)&nbsp;FROM&nbsp;rseg<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;lv_cnt<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;ebeln&nbsp;=&nbsp;gs_data-ebeln.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_cnt&nbsp;=&nbsp;lv_cnt&nbsp;+&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_data-buzei&nbsp;=&nbsp;lv_cnt.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_data-ebelp&nbsp;=&nbsp;lv_ebelp.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"###,&nbsp;###<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;name1&nbsp;FROM&nbsp;lfa1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;gs_data-lfa1_name1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;lifnr&nbsp;=&nbsp;gs_data-lifnr.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;gs_data-name1&nbsp;&lt;&gt;&nbsp;gs_data-lfa1_name1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;name1&nbsp;FROM&nbsp;lfa1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;gs_data-name1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;lifnr&nbsp;=&nbsp;gs_data-lifnr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;gs_data&nbsp;TO&nbsp;gt_data.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;lv_ebeln&nbsp;=&nbsp;gs_excel-ebeln.<br />
<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;FORM&nbsp;EDIT_DATA<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;TEXT<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;P1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT<br />
*&&nbsp;&lt;--&nbsp;&nbsp;P2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM edit_data .<br />
<br />
&nbsp;&nbsp;IF&nbsp;gv_edit&nbsp;=&nbsp;''.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gv_edit&nbsp;=&nbsp;'X'.<br />
<br />
&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;gv_edit.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;go_docking-&gt;free.<br />
&nbsp;&nbsp;CLEAR&nbsp;go_docking.<br />
&nbsp;&nbsp;CLEAR&nbsp;go_grid.<br />
<br />
<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;FORM&nbsp;INVOICE_DATA<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;TEXT<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;P1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT<br />
*&&nbsp;&lt;--&nbsp;&nbsp;P2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM invoice_data USING lt_rows  TYPE lvc_t_row<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_row&nbsp;&nbsp;&nbsp;TYPE&nbsp;lvc_s_row.<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;####<br />
*&---------------------------------------------------------------------*<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;DATA:&nbsp;ls_header&nbsp;&nbsp;TYPE&nbsp;bapi_incinv_create_header,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_item&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;bapi_incinv_create_item,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lt_item&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;bapi_incinv_create_item,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_return&nbsp;&nbsp;TYPE&nbsp;bapiret2,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lt_return&nbsp;&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;bapiret2,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_inv_num&nbsp;LIKE&nbsp;bapi_incinv_fld.<br />
<br />
&nbsp;&nbsp;"SELECTED_ROWS<br />
&nbsp;&nbsp;DATA:&nbsp;lt_data&nbsp;&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;z01t0010,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_data&nbsp;&nbsp;TYPE&nbsp;z01t0010,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_data2&nbsp;LIKE&nbsp;LINE&nbsp;OF&nbsp;gt_data,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lt_data2&nbsp;LIKE&nbsp;TABLE&nbsp;OF&nbsp;ls_data2.<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;gt_data&nbsp;INTO&nbsp;ls_data2&nbsp;WHERE&nbsp;ebeln&nbsp;=&nbsp;gs_data-ebeln.<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ls_data2&nbsp;TO&nbsp;lt_data2.<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;DATA&nbsp;:&nbsp;lv_line&nbsp;TYPE&nbsp;i.<br />
&nbsp;&nbsp;lv_line&nbsp;=&nbsp;lines(&nbsp;lt_data2&nbsp;).<br />
&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;lt_rows&nbsp;INTO&nbsp;ls_row&nbsp;INDEX&nbsp;1.<br />
&nbsp;&nbsp;DO&nbsp;lv_line&nbsp;-&nbsp;1&nbsp;TIMES.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_row-index&nbsp;=&nbsp;ls_row-index&nbsp;+&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ls_row&nbsp;TO&nbsp;lt_rows.<br />
&nbsp;&nbsp;ENDDO.<br />
<br />
   </div>
   <div class="codeComment">
**********************************************************************<br />
   </div>
   <div class="code">
&nbsp;&nbsp;"HEADER&nbsp;DATA<br />
<br />
&nbsp;&nbsp;ls_header-invoice_ind&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;ls_header-doc_type&nbsp;=&nbsp;'RE'.<br />
&nbsp;&nbsp;ls_header-doc_date&nbsp;=&nbsp;gs_data-invdat.<br />
&nbsp;&nbsp;ls_header-pstng_date&nbsp;=&nbsp;sy-datum.<br />
&nbsp;&nbsp;ls_header-comp_code&nbsp;=&nbsp;'1010'.<br />
&nbsp;&nbsp;ls_header-currency&nbsp;=&nbsp;gs_data-waers.<br />
&nbsp;&nbsp;ls_header-gross_amount&nbsp;=&nbsp;gs_data-rbwwr.<br />
&nbsp;&nbsp;ls_header-calc_tax_ind&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;ls_header-pmnttrms&nbsp;=&nbsp;'0001'.<br />
<br />
&nbsp;&nbsp;"###&nbsp;##&nbsp;###&nbsp;##<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;lt_rows&nbsp;INTO&nbsp;ls_row.<br />
&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;gt_data&nbsp;INTO&nbsp;gs_data&nbsp;INDEX&nbsp;ls_row-index.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;=&nbsp;0.<br />
   </div>
   <div class="codeComment">
**********************************************************************<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"ITEM&nbsp;DATA<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_item-invoice_doc_item&nbsp;=&nbsp;gs_data-buzei.&nbsp;"000001(6##).<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_item-po_number&nbsp;=&nbsp;gs_data-ebeln.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_item-po_item&nbsp;=&nbsp;gs_data-ebelp.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"00010(5##)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_item-quantity&nbsp;=&nbsp;gs_data-menge.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_item-tax_code&nbsp;=&nbsp;'V3'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_item-item_amount&nbsp;=&nbsp;gs_data-netwr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_item-po_unit_iso&nbsp;=&nbsp;gs_data-meins.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_item-po_unit&nbsp;=&nbsp;gs_data-meins.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ls_item&nbsp;TO&nbsp;lt_item.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;ENDLOOP.<br />
   </div>
   <div class="codeComment">
**********************************************************************<br />
   </div>
   <div class="code">
&nbsp;&nbsp;"IV&nbsp;BAPI<br />
<br />
&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'BAPI_INCOMINGINVOICE_CREATE'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;headerdata&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ls_header<br />
   </div>
   <div class="codeComment">
**&nbsp;&nbsp;&nbsp;ADDRESSDATA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;invoicedocnumber&nbsp;=&nbsp;ls_inv_num-inv_doc_no<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fiscalyear&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ls_inv_num-fisc_year<br />
&nbsp;&nbsp;&nbsp;&nbsp;TABLES<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;itemdata&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lt_item<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ACCOUNTINGDATA&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GLACCOUNTDATA&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MATERIALDATA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TAXDATA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITHTAXDATA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VENDORITEMSPLITDATA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lt_return<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXTENSIONIN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TM_ITEMDATA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NFMETALLITMS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ASSETDATA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;.<br />
<br />
&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;lt_return&nbsp;INTO&nbsp;ls_return&nbsp;WITH&nbsp;KEY&nbsp;type&nbsp;=&nbsp;'E'.<br />
&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;s000&nbsp;DISPLAY&nbsp;LIKE&nbsp;'S'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'BAPI_TRANSACTION_COMMIT'.&nbsp;"'BAPI_TRANSACTION_COMMIT'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;lt_rows&nbsp;INTO&nbsp;ls_row.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;gt_data&nbsp;INTO&nbsp;gs_data&nbsp;INDEX&nbsp;ls_row-index.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_data-belnr&nbsp;=&nbsp;ls_inv_num-inv_doc_no.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_data-icon&nbsp;=&nbsp;icon_led_green.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_data-crtyn&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_data-message&nbsp;=&nbsp;'#####&nbsp;#######.'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_data-erdat&nbsp;=&nbsp;sy-datum.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;gt_data&nbsp;FROM&nbsp;gs_data&nbsp;INDEX&nbsp;ls_row-index.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;gs_data&nbsp;TO&nbsp;ls_data.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ls_data&nbsp;TO&nbsp;lt_data.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;z01t0010&nbsp;FROM&nbsp;TABLE&nbsp;lt_data.<br />
<br />
&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'BAPI_TRANSACTION_ROLLBACK'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_data-icon&nbsp;=&nbsp;icon_led_red.<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_data-message&nbsp;=&nbsp;'#####&nbsp;######.'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;gt_data&nbsp;FROM&nbsp;gs_data&nbsp;INDEX&nbsp;ls_row-index.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;FORM&nbsp;SAVE_DATA<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;TEXT<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;P1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT<br />
*&&nbsp;&lt;--&nbsp;&nbsp;P2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM SAVE_DATA .<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;LT_DATA&nbsp;&nbsp;&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;Z01T0010,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_DATA&nbsp;&nbsp;&nbsp;TYPE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Z01T0010,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LV_ANSWER&nbsp;TYPE&nbsp;CHAR01.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;LV_LINES&nbsp;TYPE&nbsp;I.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;LT_ROWS&nbsp;TYPE&nbsp;LVC_T_ROW,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_ROWS&nbsp;TYPE&nbsp;LVC_S_ROW.<br />
<br />
<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;GO_GRID-&gt;GET_SELECTED_ROWS<br />
&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ET_INDEX_ROWS&nbsp;=&nbsp;LT_ROWS.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;ET_ROW_NO&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;GO_GRID-&gt;CHECK_CHANGED_DATA.<br />
<br />
&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;GT_DATA&nbsp;INTO&nbsp;GS_DATA&nbsp;WITH&nbsp;KEY&nbsp;ICON&nbsp;=&nbsp;ICON_LED_RED.<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;S000&nbsp;WITH&nbsp;'#####&nbsp;###&nbsp;######.'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXIT.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'POPUP_TO_CONFIRM'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TITLEBAR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'SYSTEM&nbsp;MESSAGE'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT_QUESTION&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'########?'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT_BUTTON_1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'YES'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ICON_BUTTON_1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'ICON_SYSTEM_SAVE'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT_BUTTON_2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'NO'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ICON_BUTTON_2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'ICON_CANCEL'<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEFAULT_BUTTON&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'1'<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DISPLAY_CANCEL_BUTTON&nbsp;=&nbsp;''<br />
&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANSWER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LV_ANSWER.<br />
<br />
&nbsp;&nbsp;CHECK&nbsp;LV_ANSWER&nbsp;=&nbsp;'1'.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;LS_DATA.<br />
&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;GS_DATA&nbsp;TO&nbsp;LS_DATA.<br />
<br />
&nbsp;&nbsp;LS_DATA-ERDAT&nbsp;=&nbsp;SY-DATUM.<br />
&nbsp;&nbsp;LS_DATA-ERZET&nbsp;=&nbsp;SY-UZEIT.<br />
&nbsp;&nbsp;LS_DATA-ERNAM&nbsp;=&nbsp;SY-UNAME.<br />
<br />
&nbsp;&nbsp;APPEND&nbsp;LS_DATA&nbsp;TO&nbsp;LT_DATA.<br />
<br />
&nbsp;&nbsp;MODIFY&nbsp;Z01T0010&nbsp;FROM&nbsp;TABLE&nbsp;LT_DATA.<br />
<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;COMMIT&nbsp;WORK.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-ICON&nbsp;=&nbsp;ICON_LED_GREEN.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;GS_DATA-MESSAGE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;GT_DATA&nbsp;FROM&nbsp;GS_DATA&nbsp;TRANSPORTING&nbsp;ICON&nbsp;MESSAGE<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;ICON&nbsp;=&nbsp;ICON_LED_YELLOW.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;S099&nbsp;WITH&nbsp;'#####&nbsp;#######.'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ROLLBACK&nbsp;WORK.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GT_DATA&nbsp;INTO&nbsp;GS_DATA&nbsp;WHERE&nbsp;ICON&nbsp;=&nbsp;ICON_LED_RED.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-ICON&nbsp;=&nbsp;ICON_LED_RED.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-MESSAGE&nbsp;=&nbsp;'###&nbsp;##&nbsp;##.'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;GT_DATA&nbsp;FROM&nbsp;GS_DATA.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;FORM&nbsp;MODIFY_SCREEN<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;TEXT<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;P1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT<br />
*&&nbsp;&lt;--&nbsp;&nbsp;P2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM modify_screen .<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;SCREEN.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;'X'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;p_rb1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;screen-group1&nbsp;=&nbsp;'DIS'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;screen-input&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;screen-active&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;screen-invisible&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;SCREEN.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;p_rb2.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;screen-group1&nbsp;=&nbsp;'EXE'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;screen-input&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;screen-active&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;screen-invisible&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;SCREEN.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDCASE.<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;FORM&nbsp;SET_FIELDCAT2<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;TEXT<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;P1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT<br />
*&&nbsp;&lt;--&nbsp;&nbsp;P2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM set_fieldcat2 .<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fieldcat.<br />
&nbsp;&nbsp;gs_fieldcat-fieldname&nbsp;=&nbsp;'EBELN'.<br />
&nbsp;&nbsp;gs_fieldcat-coltext&nbsp;=&nbsp;'####'.<br />
&nbsp;&nbsp;gs_fieldcat-key&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;gs_fieldcat-ref_table&nbsp;=&nbsp;'Z01T0010'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fieldcat&nbsp;TO&nbsp;gt_fieldcat2.<br />
<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fieldcat.<br />
&nbsp;&nbsp;gs_fieldcat-fieldname&nbsp;=&nbsp;'INVDAT'.<br />
&nbsp;&nbsp;gs_fieldcat-coltext&nbsp;=&nbsp;'####'.<br />
&nbsp;&nbsp;gs_fieldcat-just&nbsp;=&nbsp;'L'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fieldcat&nbsp;TO&nbsp;gt_fieldcat2.<br />
<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fieldcat.<br />
&nbsp;&nbsp;gs_fieldcat-fieldname&nbsp;=&nbsp;'STCEG'.<br />
&nbsp;&nbsp;gs_fieldcat-coltext&nbsp;=&nbsp;'#####'.<br />
&nbsp;&nbsp;gs_fieldcat-ref_table&nbsp;=&nbsp;'Z01T0010'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fieldcat&nbsp;TO&nbsp;gt_fieldcat2.<br />
<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fieldcat.<br />
&nbsp;&nbsp;gs_fieldcat-fieldname&nbsp;=&nbsp;'NAME1'.<br />
&nbsp;&nbsp;gs_fieldcat-coltext&nbsp;=&nbsp;'###'.<br />
&nbsp;&nbsp;gs_fieldcat-ref_table&nbsp;=&nbsp;'Z01T0010'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fieldcat&nbsp;TO&nbsp;gt_fieldcat2.<br />
<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fieldcat.<br />
&nbsp;&nbsp;gs_fieldcat-fieldname&nbsp;=&nbsp;'LIFNR'.<br />
&nbsp;&nbsp;gs_fieldcat-coltext&nbsp;=&nbsp;'####'.<br />
&nbsp;&nbsp;gs_fieldcat-ref_table&nbsp;=&nbsp;'Z01T0010'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fieldcat&nbsp;TO&nbsp;gt_fieldcat2.<br />
<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fieldcat.<br />
&nbsp;&nbsp;gs_fieldcat-fieldname&nbsp;=&nbsp;'MATNR'.<br />
&nbsp;&nbsp;gs_fieldcat-coltext&nbsp;=&nbsp;'##'.<br />
&nbsp;&nbsp;gs_fieldcat-ref_table&nbsp;=&nbsp;'Z01T0010'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fieldcat&nbsp;TO&nbsp;gt_fieldcat2.<br />
<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fieldcat.<br />
&nbsp;&nbsp;gs_fieldcat-fieldname&nbsp;=&nbsp;'TXZ01'.<br />
&nbsp;&nbsp;gs_fieldcat-coltext&nbsp;=&nbsp;'##'.<br />
&nbsp;&nbsp;gs_fieldcat-ref_table&nbsp;=&nbsp;'Z01T0010'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fieldcat&nbsp;TO&nbsp;gt_fieldcat2.<br />
<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fieldcat.<br />
&nbsp;&nbsp;gs_fieldcat-fieldname&nbsp;=&nbsp;'MENGE'.<br />
&nbsp;&nbsp;gs_fieldcat-coltext&nbsp;=&nbsp;'##'.<br />
&nbsp;&nbsp;gs_fieldcat-ref_table&nbsp;=&nbsp;'Z01T0010'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fieldcat&nbsp;TO&nbsp;gt_fieldcat2.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fieldcat.<br />
&nbsp;&nbsp;gs_fieldcat-fieldname&nbsp;=&nbsp;'MEINS'.<br />
&nbsp;&nbsp;gs_fieldcat-coltext&nbsp;=&nbsp;'##'.<br />
&nbsp;&nbsp;gs_fieldcat-just&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;gs_fieldcat-ref_table&nbsp;=&nbsp;'Z01T0010'.<br />
&nbsp;&nbsp;gs_fieldcat-ref_field&nbsp;=&nbsp;'MEINS'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fieldcat&nbsp;TO&nbsp;gt_fieldcat2.<br />
<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fieldcat.<br />
&nbsp;&nbsp;gs_fieldcat-fieldname&nbsp;=&nbsp;'NETPR'.<br />
&nbsp;&nbsp;gs_fieldcat-coltext&nbsp;=&nbsp;'##'.<br />
&nbsp;&nbsp;gs_fieldcat-just&nbsp;&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;gs_fieldcat-ref_table&nbsp;=&nbsp;'Z01T0010'.<br />
&nbsp;&nbsp;gs_fieldcat-emphasize&nbsp;=&nbsp;'C300'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fieldcat&nbsp;TO&nbsp;gt_fieldcat2.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fieldcat.<br />
&nbsp;&nbsp;gs_fieldcat-fieldname&nbsp;=&nbsp;'NETWR'.<br />
&nbsp;&nbsp;gs_fieldcat-coltext&nbsp;=&nbsp;'####'.<br />
&nbsp;&nbsp;gs_fieldcat-ref_table&nbsp;=&nbsp;'Z01T0010'.<br />
&nbsp;&nbsp;gs_fieldcat-cfieldname&nbsp;=&nbsp;'WAERS'.<br />
&nbsp;&nbsp;gs_fieldcat-emphasize&nbsp;=&nbsp;'C500'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fieldcat&nbsp;TO&nbsp;gt_fieldcat2.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fieldcat.<br />
&nbsp;&nbsp;gs_fieldcat-fieldname&nbsp;=&nbsp;'BRTWR'.<br />
&nbsp;&nbsp;gs_fieldcat-coltext&nbsp;=&nbsp;'#####'.<br />
&nbsp;&nbsp;gs_fieldcat-ref_table&nbsp;=&nbsp;'Z01T0010'.<br />
&nbsp;&nbsp;gs_fieldcat-cfieldname&nbsp;=&nbsp;'WAERS'.<br />
&nbsp;&nbsp;gs_fieldcat-emphasize&nbsp;=&nbsp;'C500'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fieldcat&nbsp;TO&nbsp;gt_fieldcat2.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fieldcat.<br />
&nbsp;&nbsp;gs_fieldcat-fieldname&nbsp;=&nbsp;'MWSKZ'.<br />
&nbsp;&nbsp;gs_fieldcat-coltext&nbsp;=&nbsp;'##'.<br />
&nbsp;&nbsp;gs_fieldcat-ref_table&nbsp;=&nbsp;'Z01T0010'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fieldcat&nbsp;TO&nbsp;gt_fieldcat2.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fieldcat.<br />
&nbsp;&nbsp;gs_fieldcat-fieldname&nbsp;=&nbsp;'RBWWR'.<br />
&nbsp;&nbsp;gs_fieldcat-coltext&nbsp;=&nbsp;'####'.<br />
&nbsp;&nbsp;gs_fieldcat-ref_table&nbsp;=&nbsp;'Z01T0010'.<br />
&nbsp;&nbsp;gs_fieldcat-emphasize&nbsp;=&nbsp;'C500'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fieldcat&nbsp;TO&nbsp;gt_fieldcat2.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fieldcat.<br />
&nbsp;&nbsp;gs_fieldcat-fieldname&nbsp;=&nbsp;'WAERS'.<br />
&nbsp;&nbsp;gs_fieldcat-coltext&nbsp;=&nbsp;'##'.<br />
&nbsp;&nbsp;gs_fieldcat-ref_table&nbsp;=&nbsp;'Z01T0010'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fieldcat&nbsp;TO&nbsp;gt_fieldcat2.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fieldcat.<br />
&nbsp;&nbsp;gs_fieldcat-fieldname&nbsp;=&nbsp;'BELNR'.<br />
&nbsp;&nbsp;gs_fieldcat-coltext&nbsp;=&nbsp;'####'.<br />
&nbsp;&nbsp;gs_fieldcat-ref_table&nbsp;=&nbsp;'RBKP'.<br />
&nbsp;&nbsp;gs_fieldcat-hotspot&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;gs_fieldcat-col_opt&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;gs_fieldcat-emphasize&nbsp;=&nbsp;'C700'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fieldcat&nbsp;TO&nbsp;gt_fieldcat2.<br />
<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gs_fieldcat.<br />
&nbsp;&nbsp;gs_fieldcat-fieldname&nbsp;=&nbsp;'CRTYN'.<br />
&nbsp;&nbsp;gs_fieldcat-coltext&nbsp;=&nbsp;'####'.<br />
&nbsp;&nbsp;gs_fieldcat-ref_table&nbsp;=&nbsp;'Z01T0010'.<br />
&nbsp;&nbsp;gs_fieldcat-just&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;gs_fieldcat-checkbox&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_fieldcat&nbsp;TO&nbsp;gt_fieldcat2.<br />
<br />
<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;FORM&nbsp;INPUT_IMAGE<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;TEXT<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;P1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT<br />
*&&nbsp;&lt;--&nbsp;&nbsp;P2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM input_image .<br />
<br />
&nbsp;&nbsp;DATA&nbsp;:&nbsp;ls_object&nbsp;&nbsp;TYPE&nbsp;sibflporb,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lt_objects&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;sibflporb,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lt_rows&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;lvc_t_row,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_subrc&nbsp;&nbsp;&nbsp;TYPE&nbsp;sy-subrc.<br />
<br />
<br />
<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;go_grid-&gt;get_selected_rows<br />
&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;et_index_rows&nbsp;=&nbsp;gt_rows.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ET_ROW_NO&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;lt_rows&nbsp;INTO&nbsp;DATA(ls_row).<br />
&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;gt_data&nbsp;INTO&nbsp;gs_data&nbsp;INDEX&nbsp;ls_row.<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;PERFORM&nbsp;chk_attach&nbsp;TABLES&nbsp;lt_objects<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USING&nbsp;gs_data-ebeln&nbsp;ls_object&nbsp;lv_subrc.<br />
&nbsp;&nbsp;ls_object-instid&nbsp;=&nbsp;gs_data-ebeln.<br />
&nbsp;&nbsp;ls_object-typeid&nbsp;=&nbsp;sy-repid.<br />
&nbsp;&nbsp;ls_object-catid&nbsp;&nbsp;=&nbsp;'BO'.<br />
<br />
<br />
&nbsp;&nbsp;SELECT&nbsp;*&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;lt_objects<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;srgbtbrel<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;reltype&nbsp;=&nbsp;'ATTA'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;&nbsp;&nbsp;instid_a&nbsp;=&nbsp;ls_object-instid<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;&nbsp;typeid_a&nbsp;&nbsp;=&nbsp;ls_object-typeid<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;&nbsp;&nbsp;catid_a&nbsp;&nbsp;=&nbsp;ls_object-catid.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'GOS_ATTACHMENT_LIST_POPUP'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is_object&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ls_object<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ip_check_arl&nbsp;&nbsp;&nbsp;=&nbsp;'X'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ip_check_bds&nbsp;&nbsp;&nbsp;=&nbsp;'X'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ip_notes&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ip_attachments&nbsp;=&nbsp;'X'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ip_urls&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ip_mode&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gv_mode<br />
   </div>
   <div class="codeComment">
*&nbsp;IMPORTING<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EP_SAVE_REQUEST&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;TABLES<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it_objects&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lt_objects.<br />
<br />
&nbsp;&nbsp;IF&nbsp;gv_mode&nbsp;=&nbsp;'E'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;COMMIT&nbsp;WORK&nbsp;AND&nbsp;WAIT.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;FORM&nbsp;CREATE_OBJECT2<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;TEXT<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;P1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT<br />
*&&nbsp;&lt;--&nbsp;&nbsp;P2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM create_object2 .<br />
<br />
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;go_container2<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;container_name&nbsp;=&nbsp;'GO_CONTAINER2'.<br />
<br />
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;go_grid2<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_parent&nbsp;=&nbsp;go_container2.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;FORM&nbsp;DISPLAY_ALV2<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;TEXT<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;P1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT<br />
*&&nbsp;&lt;--&nbsp;&nbsp;P2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM display_alv2 .<br />
<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;go_grid2-&gt;set_table_for_first_display<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_BUFFER_ACTIVE&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_BYPASSING_BUFFER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_CONSISTENCY_CHECK&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_STRUCTURE_NAME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS_VARIANT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_SAVE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_DEFAULT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is_layout&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_layout2<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS_PRINT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_SPECIAL_GROUPS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_TOOLBAR_EXCLUDING&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_HYPERLINK&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_ALV_GRAPHICS&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_EXCEPT_QINFO&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IR_SALV_ADAPTER&nbsp;=<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;CHANGING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it_outtab&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gt_data2<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it_fieldcatalog&nbsp;=&nbsp;gt_fieldcat2<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it_sort&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gt_sort2<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_FILTER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;EXCEPTIONS<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INVALID_PARAMETER_COMBINATION&nbsp;=&nbsp;1<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PROGRAM_ERROR&nbsp;&nbsp;&nbsp;=&nbsp;2<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TOO_MANY_LINES&nbsp;&nbsp;=&nbsp;3<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;4<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;.<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;FORM&nbsp;REFRESH_ALV2<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;TEXT<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;P1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT<br />
*&&nbsp;&lt;--&nbsp;&nbsp;P2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM refresh_alv2 .<br />
<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;go_grid2-&gt;refresh_table_display.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;FORM&nbsp;SET_LAYOUT2<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;TEXT<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;P1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT<br />
*&&nbsp;&lt;--&nbsp;&nbsp;P2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM set_layout2 .<br />
<br />
&nbsp;&nbsp;gs_layout2-sel_mode&nbsp;=&nbsp;'D'.<br />
&nbsp;&nbsp;gs_layout2-cwidth_opt&nbsp;=&nbsp;'A'.<br />
&nbsp;&nbsp;gs_layout2-zebra&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;gs_layout2-stylefname&nbsp;&nbsp;=&nbsp;'STYLE'.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;FORM&nbsp;SET_SORT2<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;TEXT<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;P1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT<br />
*&&nbsp;&lt;--&nbsp;&nbsp;P2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM set_sort2 .<br />
<br />
&nbsp;&nbsp;CLEAR:&nbsp;gs_sort2,&nbsp;gt_sort2.<br />
<br />
&nbsp;&nbsp;gs_sort2-fieldname&nbsp;=&nbsp;'EBELN'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_sort2&nbsp;TO&nbsp;gt_sort2.<br />
<br />
&nbsp;&nbsp;gs_sort2-fieldname&nbsp;=&nbsp;'STCEG'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_sort2&nbsp;TO&nbsp;gt_sort2.<br />
<br />
&nbsp;&nbsp;gs_sort2-fieldname&nbsp;=&nbsp;'NAME1'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_sort2&nbsp;TO&nbsp;gt_sort2.<br />
<br />
&nbsp;&nbsp;gs_sort2-fieldname&nbsp;=&nbsp;'LIFNR'.<br />
&nbsp;&nbsp;APPEND&nbsp;gs_sort2&nbsp;TO&nbsp;gt_sort2.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;FORM&nbsp;CHECK_INVDAT<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;TEXT<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;GS_EXCEL_INVDAT<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;--&nbsp;GS_DATA<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM check_invdat  USING    p_invdat<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;p_data&nbsp;TYPE&nbsp;ty_data.<br />
<br />
&nbsp;&nbsp;DATA&nbsp;:&nbsp;lv_date&nbsp;&nbsp;TYPE&nbsp;char10,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_date2&nbsp;TYPE&nbsp;sy-datum.<br />
<br />
&nbsp;&nbsp;CHECK&nbsp;p_invdat&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
<br />
&nbsp;&nbsp;lv_date&nbsp;=&nbsp;p_invdat.<br />
<br />
&nbsp;&nbsp;REPLACE&nbsp;ALL&nbsp;OCCURRENCES&nbsp;OF&nbsp;'-'&nbsp;IN&nbsp;lv_date&nbsp;WITH&nbsp;''.<br />
&nbsp;&nbsp;REPLACE&nbsp;ALL&nbsp;OCCURRENCES&nbsp;OF&nbsp;'.'&nbsp;IN&nbsp;lv_date&nbsp;WITH&nbsp;''.<br />
&nbsp;&nbsp;REPLACE&nbsp;ALL&nbsp;OCCURRENCES&nbsp;OF&nbsp;','&nbsp;IN&nbsp;lv_date&nbsp;WITH&nbsp;''.<br />
&nbsp;&nbsp;REPLACE&nbsp;ALL&nbsp;OCCURRENCES&nbsp;OF&nbsp;'/'&nbsp;IN&nbsp;lv_date&nbsp;WITH&nbsp;''.<br />
<br />
&nbsp;&nbsp;lv_date2&nbsp;=&nbsp;lv_date.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'DATE_CHECK_PLAUSIBILITY'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;date&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lv_date2<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plausibility_check_failed&nbsp;=&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2.<br />
&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;p_data-icon&nbsp;=&nbsp;icon_led_red.<br />
&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;set_message&nbsp;USING&nbsp;'####&nbsp;##&nbsp;####.'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;p_data-message.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;p_data-invdat&nbsp;=&nbsp;lv_date2.<br />
<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;FORM&nbsp;CHECK_MATNR<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;TEXT<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;GS_EXCEL_MATNR<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;--&nbsp;GS_DATA<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM check_matnr  USING p_matnr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;p_data&nbsp;TYPE&nbsp;ty_data.<br />
<br />
&nbsp;&nbsp;p_data-matnr&nbsp;=&nbsp;p_matnr.<br />
<br />
&nbsp;&nbsp;IF&nbsp;p_matnr+0(8)&nbsp;&lt;&gt;&nbsp;'AI01_R00'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;p_data-icon&nbsp;=&nbsp;icon_led_red.<br />
&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;set_message&nbsp;USING&nbsp;'##&nbsp;###&nbsp;##.'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;p_data-message.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;FORM&nbsp;CHECK_TXZ01<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;TEXT<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;GS_EXCEL_TXZ01<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;--&nbsp;GS_DATA<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM check_txz01  USING    p_txz01<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;p_data&nbsp;TYPE&nbsp;ty_data.<br />
<br />
&nbsp;&nbsp;p_data-txz01&nbsp;=&nbsp;&nbsp;p_txz01.<br />
<br />
<br />
&nbsp;&nbsp;IF&nbsp;p_txz01+0(4)&nbsp;&lt;&gt;&nbsp;'AI01'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;p_data-icon&nbsp;=&nbsp;icon_led_red.<br />
&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;set_message&nbsp;USING&nbsp;'##&nbsp;###&nbsp;##.'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;p_data-message.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;FORM&nbsp;SET_MESSAGE<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;TEXT<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;P_<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;--&nbsp;PS_DISP_MESSAGE<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM set_message  USING    p_new_message<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;p_message.<br />
<br />
&nbsp;&nbsp;IF&nbsp;p_message&nbsp;IS&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;p_message&nbsp;=&nbsp;p_new_message.<br />
&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CONCATENATE&nbsp;p_message&nbsp;p_new_message&nbsp;INTO&nbsp;p_message<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SEPARATED&nbsp;BY&nbsp;'#'.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;FORM&nbsp;DISMESSAGE<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;TEXT<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;P1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT<br />
*&&nbsp;&lt;--&nbsp;&nbsp;P2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM dismessage .<br />
<br />
&nbsp;&nbsp;DATA&nbsp;:&nbsp;lv_line&nbsp;&nbsp;TYPE&nbsp;i,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_line2&nbsp;TYPE&nbsp;i.<br />
&nbsp;&nbsp;lv_line&nbsp;=&nbsp;lines(&nbsp;gt_data&nbsp;).<br />
&nbsp;&nbsp;lv_line2&nbsp;=&nbsp;lines(&nbsp;gt_data&nbsp;).<br />
<br />
&nbsp;&nbsp;MESSAGE&nbsp;s001&nbsp;INTO&nbsp;gv_grid_title&nbsp;WITH&nbsp;lv_line.&nbsp;&nbsp;"##&nbsp;#&nbsp;#&nbsp;:&nbsp;&<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;MESSAGE&nbsp;S005&nbsp;INTO&nbsp;gv_grid_title2&nbsp;WITH&nbsp;lv_line2.<br />
<br />
<br />
   </div>
   <div class="code">
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;FORM&nbsp;HANDLE_HOTSPOT_CLICK<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;TEXT<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;E_ROW_ID<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;E_COLUMN_ID<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM handle_hotspot_click  USING    ps_row TYPE lvc_s_row<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ps_col&nbsp;TYPE&nbsp;lvc_s_col.<br />
<br />
&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;gt_data&nbsp;INTO&nbsp;gs_data&nbsp;INDEX&nbsp;ps_row.<br />
&nbsp;&nbsp;CASE&nbsp;ps_col-fieldname.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'ATTACH'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;input_image.<br />
&nbsp;&nbsp;ENDCASE.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;FORM&nbsp;SET_EXCLUDE<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;TEXT<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;P1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT<br />
*&&nbsp;&lt;--&nbsp;&nbsp;P2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM set_exclude .<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gt_exclude.<br />
&nbsp;&nbsp;APPEND&nbsp;go_grid-&gt;mc_fc_sort_asc&nbsp;TO&nbsp;gt_exclude.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;set_exclude2<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM set_exclude2 .<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;gt_exclude.<br />
&nbsp;&nbsp;APPEND&nbsp;go_grid2-&gt;mc_fc_sort_asc&nbsp;TO&nbsp;gt_exclude.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;set_event2<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM set_event2 .<br />
<br />
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;go_event_receiver.<br />
<br />
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;:&nbsp;go_event_receiver-&gt;handle_hotspot_click2&nbsp;FOR&nbsp;go_grid2.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;go_grid2-&gt;register_edit_event<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_event_id&nbsp;=&nbsp;go_grid2-&gt;mc_evt_modified.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;HANDLE_TOOLBAR<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;E_OBJECT<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM handle_toolbar  USING    p_e_object.<br />
<br />
&nbsp;&nbsp;DATA&nbsp;ls_button&nbsp;TYPE&nbsp;stb_button.<br />
<br />
&nbsp;&nbsp;ls_button-function&nbsp;=&nbsp;'B1'.<br />
&nbsp;&nbsp;ls_button-icon&nbsp;&nbsp;=&nbsp;icon_system_save.<br />
&nbsp;&nbsp;ls_button-text&nbsp;=&nbsp;'####'.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;HANDLE_HOTSPOT_CLICK2<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;E_ROW_ID<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;E_COLUMN_ID<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM handle_hotspot_click2  USING   ps_row TYPE lvc_s_row<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ps_col&nbsp;TYPE&nbsp;lvc_s_col.<br />
<br />
&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;gt_data2&nbsp;INTO&nbsp;gs_data2&nbsp;INDEX&nbsp;ps_row.<br />
&nbsp;&nbsp;CASE&nbsp;ps_col-fieldname.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'BELNR'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;PARAMETER&nbsp;ID&nbsp;'RBN'&nbsp;FIELD&nbsp;gs_data2-belnr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;TRANSACTION&nbsp;'MIR4'&nbsp;AND&nbsp;SKIP&nbsp;FIRST&nbsp;SCREEN.<br />
<br />
&nbsp;&nbsp;ENDCASE.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;CHK_ATTACH<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;GS_DATA_EBELN<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM chk_attach  TABLES lt_objects STRUCTURE sibflporb<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USING&nbsp;&nbsp;pv_ebeln<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_object&nbsp;TYPE&nbsp;sibflporb<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_subrc.<br />
<br />
&nbsp;&nbsp;ls_object-instid&nbsp;=&nbsp;pv_ebeln.<br />
&nbsp;&nbsp;ls_object-typeid&nbsp;=&nbsp;sy-repid.<br />
&nbsp;&nbsp;ls_object-catid&nbsp;&nbsp;=&nbsp;'BO'.<br />
<br />
<br />
&nbsp;&nbsp;SELECT&nbsp;*&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;lt_objects<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;srgbtbrel<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;reltype&nbsp;=&nbsp;'ATTA'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;&nbsp;&nbsp;instid_a&nbsp;=&nbsp;ls_object-instid<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;&nbsp;typeid_a&nbsp;&nbsp;=&nbsp;ls_object-typeid<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;&nbsp;&nbsp;catid_a&nbsp;&nbsp;=&nbsp;ls_object-catid.<br />
&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;lv_subrc&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;lv_subrc&nbsp;=&nbsp;4.<br />
&nbsp;&nbsp;ENDIF.<br />
ENDFORM.<br />
            </div>
          </td>
        </tr>
      </table>
      </td>
      </tr>
   <tr>
<td class="footer">Extracted by Mass Download version 1.5.5 - E.G.Mellodew. 1998-2021. Sap Release 754</td>
   </tr>
</table>
</body>
</html>
