<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=EUC-KR" />
<meta http-equiv="Content-Type" content="application/xhtml+xml; EUC-KR" />
<title>ZCODE_RESULT</title>
<style type="text/css">
.code{ font-family:"Courier New", Courier, monospace; color:#000; font-size:14px; background-color:#F2F4F7 }
  .codeComment {font-family:"Courier New", Courier, monospace; color:#0000F0; font-size:14px; background-color:#F2F4F7 }
  .normalBold{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px; font-weight:800 }
  .normalBoldLarge{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:16px; font-weight:800 }
</style>
<style type="text/css">
  .normal{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px }
  .footer{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px; text-align: center }
  h2{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:16px; font-weight:800 }
  h3{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:14px; font-weight:800 }
  .outerTable{
   background-color:#E0E7ED;
   width:100%;
   border-top-width: thin;
   border-right-width: thin;
   border-right-width: thin;
   border-left-width: thin;
   border-top-style: solid;
   border-right-style: solid;
   border-bottom-style: solid;
   border-left-style: solid;
  }
  .innerTable{
   background-color:#F2F4F7;
   width:100%;
   border-top-width: thin;
   border-right-width: thin;
   border-bottom-width: thin;
   border-left-width: thin;
   border-top-style: solid;
   border-right-style: solid;
   border-bottom-style: solid;
   border-left-style: solid;
  }
</style>
</head>
<body>
<table class="outerTable">
  <tr class="normalBoldLarge">
     <td><h2>Code listing for: ZCODE_RESULT</h2>
<h3> Description: Program ZCODE_RESULT</h3></td>
   </tr>
  <tr>
     <td>
     <table class="innerTable">
       <tr>
          <td>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Report&nbsp;ZCODE_RESULT<br />
*&---------------------------------------------------------------------*<br />
*&<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
REPORT ZCODE_RESULT.<br />
<br />
   </div>
   <div class="codeComment">
**INITIALIZATION.<br />
*<br />
*"##&nbsp;##&nbsp;#&nbsp;INITIALIZATION&nbsp;#&nbsp;##<br />
*DATA:&nbsp;LV_DATUM&nbsp;TYPE&nbsp;P0001-BEGDA.<br />
*<br />
*&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'RP_CALC_DATE_IN_INTERVAL'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;SY-DATUM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"###<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DAYS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'07'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"#<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MONTHS&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'00'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"#<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIGNUM&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'-'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;+,&nbsp;-<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;YEARS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'00'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"##<br />
*&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALC_DATE&nbsp;=&nbsp;LV_DATUM.<br />
<br />
<br />
*"##&nbsp;#####&nbsp;##&nbsp;###&nbsp;##<br />
*DATA&nbsp;:&nbsp;GV_DIR&nbsp;TYPE&nbsp;STRING,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GV_RC&nbsp;&nbsp;TYPE&nbsp;ABAP_BOOL.<br />
*&nbsp;&nbsp;CLEAR&nbsp;GV_DIR.<br />
*&nbsp;&nbsp;GV_DIR&nbsp;=&nbsp;'C:\EXCEL\'&nbsp;&&&nbsp;SY-DATUM+0(4)&nbsp;&&&nbsp;'-'&nbsp;&&&nbsp;SY-DATUM+4(2)&nbsp;&&&nbsp;'-'&nbsp;&&&nbsp;SY-DATUM+6(2).&nbsp;&nbsp;"C:\EXCEL\###&nbsp;###&nbsp;###&nbsp;##&nbsp;##&nbsp;##&nbsp;##&nbsp;&nbsp;EX)'C:\EXCEL\07-06'<br />
*<br />
*&nbsp;&nbsp;"##&nbsp;##&nbsp;##<br />
*&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;CL_GUI_FRONTEND_SERVICES=&gt;DIRECTORY_EXIST<br />
*&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIRECTORY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GV_DIR<br />
*&nbsp;&nbsp;&nbsp;&nbsp;RECEIVING<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RESULT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GV_RC<br />
*&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CNTL_ERROR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ERROR_NO_GUI&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRONG_PARAMETER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;3<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NOT_SUPPORTED_BY_GUI&nbsp;=&nbsp;4<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;5.<br />
*<br />
*&nbsp;&nbsp;IF&nbsp;GV_RC&nbsp;&lt;&gt;&nbsp;'X'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;LV_CHECK&nbsp;=&nbsp;1.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;S000&nbsp;DISPLAY&nbsp;LIKE&nbsp;'E'&nbsp;WITH&nbsp;GV_DIR.&nbsp;"##&nbsp;###&nbsp;####&nbsp;####.&nbsp;:&nbsp;&<br />
*&nbsp;&nbsp;ENDIF.<br />
<br />
**********************************************************************<br />
<br />
   </div>
   <div class="code">
" #### ## ## ## ## ### ##<br />
<br />
   </div>
   <div class="codeComment">
*CALL&nbsp;METHOD&nbsp;CL_GUI_FRONTEND_SERVICES=&gt;DIRECTORY_LIST_FILES<br />
*&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIRECTORY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GV_DIR<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FILTER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'*.JPG'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FILES_ONLY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIRECTORIES_ONLY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;CHANGING<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FILE_TABLE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GT_FILETAB[]<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COUNT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GV_COUNT<br />
*&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CNTL_ERROR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DIRECTORY_LIST_FILES_FAILED&nbsp;=&nbsp;2<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRONG_PARAMETER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;3<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ERROR_NO_GUI&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;4<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NOT_SUPPORTED_BY_GUI&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;5<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;6.<br />
<br />
**********************************************************************<br />
<br />
   </div>
   <div class="code">
" MM01(#####) BAPI TOP<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;DATA:&nbsp;GS_HEAD&nbsp;&nbsp;&nbsp;TYPE&nbsp;BAPI2017_GM_HEAD_01,&nbsp;"&nbsp;Importing__BAPI2017_GM_HEAD_01<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GV_GMCODE&nbsp;TYPE&nbsp;BAPI2017_GM_CODE.&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Importing__BAPI2017_GM_CODE<br />
*<br />
*&nbsp;&nbsp;DATA:&nbsp;GS_HEADRET&nbsp;TYPE&nbsp;BAPI2017_GM_HEAD_RET,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GV_MATDOC&nbsp;&nbsp;TYPE&nbsp;BAPI2017_GM_HEAD_RET-MAT_DOC,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;5000-&nbsp;GR##.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GV_RETYEAR&nbsp;TYPE&nbsp;BAPI2017_GM_HEAD_RET-DOC_YEAR.<br />
<br />
<br />
<br />
   </div>
   <div class="code">
" MM01 BAPI FUNCHION<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'BAPI_GOODSMVT_CREATE'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOODSMVT_HEADER&nbsp;&nbsp;=&nbsp;GS_HEAD<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOODSMVT_CODE&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GV_GMCODE<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TESTRUN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;TEST&nbsp;RUN!!!!!<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOODSMVT_REF_EWM&nbsp;=<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOODSMVT_PRINT_CTRL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOODSMVT_HEADRET&nbsp;=&nbsp;GS_HEADRET<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MATERIALDOCUMENT&nbsp;=&nbsp;GV_MATDOC<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MATDOCUMENTYEAR&nbsp;&nbsp;=&nbsp;GV_RETYEAR<br />
*&nbsp;&nbsp;&nbsp;&nbsp;TABLES<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOODSMVT_ITEM&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GT_ITEM<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOODSMVT_SERIALNUMBER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GT_RETURN_MSG<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOODSMVT_SERV_PART_DATA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXTENSIONIN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GOODSMVT_ITEM_CWM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
<br />
   </div>
   <div class="code">
" MIGO DIALOG<br />
   </div>
   <div class="codeComment">
*CALL&nbsp;FUNCTION&nbsp;'MIGO_DIALOG'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_ACTION&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'A04'<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_REFDOC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'R02'<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_NOTREE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_NO_AUTH_CHECK&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_SKIP_FIRST_SCREEN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_DEADEND&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_OKCODE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'OK_GO'<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_LEAVE_AFTER_POST&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_NEW_ROLLAREA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_SYTCODE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_EBELN<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_EBELP&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_MBLNR&nbsp;=&nbsp;GS_DATA2-MATDOC<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_MJAHR&nbsp;=&nbsp;GS_DISP-MJAHR<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_ZEILE&nbsp;=<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_TRANSPORT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_ORDER_NUMBER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_ORDER_ITEM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_TRANSPORT_MEANS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_TRANSPORTIDENT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_INBOUND_DELIV&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_OUTBOUND_DELIV&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_RESERVATION_NUMB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_RESERVATION_ITEM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_MOVE_TYPE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_SPEC_STOCK&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_PSTNG_DATE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_DOC_DATE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_REF_DOC_NO&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_HEADER_TXT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
**&nbsp;EXCEPTIONS<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ILLEGAL_COMBINATION&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;=&nbsp;2<br />
*&nbsp;&nbsp;&nbsp;&nbsp;.<br />
*&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
*&nbsp;&nbsp;ENDIF.<br />
<br />
**********************************************************************<br />
*MM02(####)&nbsp;BAPI&nbsp;FUN<br />
*<br />
*<br />
*"####<br />
*<br />
*&nbsp;&nbsp;DATA:&nbsp;LS_HEADER&nbsp;&nbsp;TYPE&nbsp;BAPI_INCINV_CREATE_HEADER,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_ITEM&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;BAPI_INCINV_CREATE_ITEM,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LT_ITEM&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;BAPI_INCINV_CREATE_ITEM,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_RETURN&nbsp;&nbsp;TYPE&nbsp;BAPIRET2,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LT_RETURN&nbsp;&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;BAPIRET2,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_INV_NUM&nbsp;LIKE&nbsp;BAPI_INCINV_FLD.<br />
*<br />
*"HEADER&nbsp;DATA<br />
*LS_HEADER-INVOICE_IND&nbsp;=&nbsp;'X'.<br />
*LS_HEADER-DOC_TYPE&nbsp;=&nbsp;'RE'.<br />
*LS_HEADER-DOC_DATE&nbsp;=&nbsp;GS_DATA-INVDAT.<br />
*LS_HEADER-PSTNG_DATE&nbsp;=&nbsp;SY-DATUM.<br />
*LS_HEADER-COMP_CODE&nbsp;=&nbsp;'1010'.<br />
*LS_HEADER-CURRENCY&nbsp;=&nbsp;GS_DATA-WAERS.<br />
*LS_HEADER-GROSS_AMOUNT&nbsp;=&nbsp;GS_DATA-RBWWR.<br />
*LS_HEADER-CALC_TAX_IND&nbsp;=&nbsp;'X'.<br />
*LS_HEADER-PMNTTRMS&nbsp;=&nbsp;'0001'.<br />
*<br />
*<br />
*"ITEM&nbsp;DATA<br />
*<br />
*LS_ITEM-INVOICE_DOC_ITEM&nbsp;=&nbsp;GS_DATA-BUZEI.&nbsp;"000001(6##).<br />
*LS_ITEM-PO_NUMBER&nbsp;=&nbsp;GS_DATA-EBELN.<br />
*LS_ITEM-PO_ITEM&nbsp;=&nbsp;GS_DATA-EBELP.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"00010(5##)<br />
*LS_ITEM-QUANTITY&nbsp;=&nbsp;GS_DATA-MENGE.<br />
*LS_ITEM-TAX_CODE&nbsp;=&nbsp;'V3'.<br />
*LS_ITEM-ITEM_AMOUNT&nbsp;=&nbsp;GS_DATA-NETWR.<br />
*LS_ITEM-PO_UNIT_ISO&nbsp;=&nbsp;GS_DATA-MEINS.<br />
*LS_ITEM-PO_UNIT&nbsp;=&nbsp;GS_DATA-MEINS.<br />
*APPEND&nbsp;LS_ITEM&nbsp;TO&nbsp;LT_ITEM.<br />
*<br />
*"IV&nbsp;BAPI<br />
*<br />
*CALL&nbsp;FUNCTION&nbsp;'BAPI_INCOMINGINVOICE_CREATE'<br />
*&nbsp;&nbsp;EXPORTING<br />
*&nbsp;&nbsp;&nbsp;&nbsp;HEADERDATA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LS_HEADER<br />
***&nbsp;&nbsp;&nbsp;ADDRESSDATA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;IMPORTING<br />
*&nbsp;&nbsp;&nbsp;&nbsp;INVOICEDOCNUMBER&nbsp;=&nbsp;LS_INV_NUM-INV_DOC_NO<br />
*&nbsp;&nbsp;&nbsp;&nbsp;FISCALYEAR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LS_INV_NUM-FISC_YEAR<br />
*&nbsp;&nbsp;TABLES<br />
*&nbsp;&nbsp;&nbsp;&nbsp;ITEMDATA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LT_ITEM<br />
**&nbsp;&nbsp;&nbsp;ACCOUNTINGDATA&nbsp;&nbsp;&nbsp;=<br />
**&nbsp;&nbsp;&nbsp;GLACCOUNTDATA&nbsp;&nbsp;&nbsp;&nbsp;=<br />
**&nbsp;&nbsp;&nbsp;MATERIALDATA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
**&nbsp;&nbsp;&nbsp;TAXDATA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
**&nbsp;&nbsp;&nbsp;WITHTAXDATA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
**&nbsp;&nbsp;&nbsp;VENDORITEMSPLITDATA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;RETURN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LT_RETURN<br />
**&nbsp;&nbsp;&nbsp;EXTENSIONIN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
**&nbsp;&nbsp;&nbsp;TM_ITEMDATA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
**&nbsp;&nbsp;&nbsp;NFMETALLITMS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
**&nbsp;&nbsp;&nbsp;ASSETDATA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;.<br />
**********************************************************************<br />
<br />
   </div>
   <div class="code">
"### ## ## ### ## FUNC.<br />
   </div>
   <div class="codeComment">
*DATA&nbsp;:&nbsp;LS_OBJECT&nbsp;&nbsp;TYPE&nbsp;SIBFLPORB,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LT_OBJECTS&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;SIBFLPORB,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LT_ROWS&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;LVC_T_ROW,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LV_SUBRC&nbsp;&nbsp;&nbsp;TYPE&nbsp;SY-SUBRC.<br />
*<br />
*CALL&nbsp;METHOD&nbsp;GO_GRID-&gt;GET_SELECTED_ROWS<br />
*&nbsp;&nbsp;IMPORTING<br />
*&nbsp;&nbsp;&nbsp;&nbsp;ET_INDEX_ROWS&nbsp;=&nbsp;GT_ROWS.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ET_ROW_NO&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*<br />
*<br />
*LOOP&nbsp;AT&nbsp;LT_ROWS&nbsp;INTO&nbsp;DATA(LS_ROW).<br />
*&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;GT_DATA&nbsp;INTO&nbsp;GS_DATA&nbsp;INDEX&nbsp;LS_ROW.<br />
*ENDLOOP.<br />
*<br />
*PERFORM&nbsp;CHK_ATTACH&nbsp;TABLES&nbsp;LT_OBJECTS<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USING&nbsp;GS_DATA-EBELN&nbsp;LS_OBJECT&nbsp;LV_SUBRC.<br />
*LS_OBJECT-INSTID&nbsp;=&nbsp;GS_DATA-EBELN.<br />
*LS_OBJECT-TYPEID&nbsp;=&nbsp;SY-REPID.<br />
*LS_OBJECT-CATID&nbsp;&nbsp;=&nbsp;'BO'.<br />
*<br />
*<br />
*SELECT&nbsp;*&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;LT_OBJECTS<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;SRGBTBREL<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;RELTYPE&nbsp;=&nbsp;'ATTA'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;&nbsp;&nbsp;INSTID_A&nbsp;=&nbsp;LS_OBJECT-INSTID<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;&nbsp;TYPEID_A&nbsp;&nbsp;=&nbsp;LS_OBJECT-TYPEID<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;&nbsp;&nbsp;CATID_A&nbsp;&nbsp;=&nbsp;LS_OBJECT-CATID.<br />
*<br />
*CALL&nbsp;FUNCTION&nbsp;'GOS_ATTACHMENT_LIST_POPUP'<br />
*&nbsp;&nbsp;EXPORTING<br />
*&nbsp;&nbsp;&nbsp;&nbsp;IS_OBJECT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LS_OBJECT<br />
*&nbsp;&nbsp;&nbsp;&nbsp;IP_CHECK_ARL&nbsp;&nbsp;&nbsp;=&nbsp;'X'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;IP_CHECK_BDS&nbsp;&nbsp;&nbsp;=&nbsp;'X'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;IP_NOTES&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;IP_ATTACHMENTS&nbsp;=&nbsp;'X'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;IP_URLS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;IP_MODE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'E'&nbsp;&nbsp;&nbsp;"&nbsp;gv_mode&nbsp;TYPE&nbsp;c&nbsp;VALUE&nbsp;'E',<br />
**&nbsp;IMPORTING<br />
**&nbsp;&nbsp;&nbsp;EP_SAVE_REQUEST&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;TABLES<br />
*&nbsp;&nbsp;&nbsp;&nbsp;IT_OBJECTS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LT_OBJECTS.<br />
*<br />
*IF&nbsp;GV_MODE&nbsp;=&nbsp;'E'.<br />
*&nbsp;&nbsp;COMMIT&nbsp;WORK&nbsp;AND&nbsp;WAIT.<br />
*ENDIF.<br />
<br />
   </div>
   <div class="code">
"###### ##<br />
   </div>
   <div class="codeComment">
*FORM&nbsp;CHK_ATTACH&nbsp;&nbsp;TABLES&nbsp;LT_OBJECTS&nbsp;STRUCTURE&nbsp;SIBFLPORB<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USING&nbsp;&nbsp;PV_EBELN<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_OBJECT&nbsp;TYPE&nbsp;SIBFLPORB<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LV_SUBRC.<br />
*<br />
*&nbsp;&nbsp;LS_OBJECT-INSTID&nbsp;=&nbsp;PV_EBELN.<br />
*&nbsp;&nbsp;LS_OBJECT-TYPEID&nbsp;=&nbsp;SY-REPID.<br />
*&nbsp;&nbsp;LS_OBJECT-CATID&nbsp;&nbsp;=&nbsp;'BO'.<br />
*<br />
*<br />
*&nbsp;&nbsp;SELECT&nbsp;*&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;LT_OBJECTS<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;SRGBTBREL<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;RELTYPE&nbsp;=&nbsp;'ATTA'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;&nbsp;&nbsp;INSTID_A&nbsp;=&nbsp;LS_OBJECT-INSTID<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;&nbsp;TYPEID_A&nbsp;&nbsp;=&nbsp;LS_OBJECT-TYPEID<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;&nbsp;&nbsp;CATID_A&nbsp;&nbsp;=&nbsp;LS_OBJECT-CATID.<br />
*&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;=&nbsp;0.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LV_SUBRC&nbsp;=&nbsp;0.<br />
*&nbsp;&nbsp;ELSE.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LV_SUBRC&nbsp;=&nbsp;4.<br />
*&nbsp;&nbsp;ENDIF.<br />
*ENDFORM.<br />
<br />
<br />
**********************************************************************<br />
*SD&nbsp;BAPI_SALESORDER_CREATEFROMDAT2<br />
<br />
*DATA:&nbsp;ls_header&nbsp;&nbsp;TYPE&nbsp;bapisdhd1,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_headerx&nbsp;TYPE&nbsp;bapisdhd1x.<br />
*<br />
**&nbsp;&nbsp;Importing<br />
*&nbsp;&nbsp;DATA:&nbsp;lv_vbeln&nbsp;&nbsp;&nbsp;TYPE&nbsp;bapivbeln-vbeln.<br />
*<br />
**&nbsp;&nbsp;Tables<br />
*&nbsp;&nbsp;DATA:&nbsp;ls_return&nbsp;&nbsp;TYPE&nbsp;bapiret2,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lt_return&nbsp;&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;bapiret2,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_partner&nbsp;TYPE&nbsp;bapiparnr,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lt_partner&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;bapiparnr,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_item&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;BAPISDITM,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lt_item&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;BAPISDITM,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_itemx&nbsp;&nbsp;&nbsp;TYPE&nbsp;BAPISDITMX,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lt_itemx&nbsp;&nbsp;&nbsp;TYPE&nbsp;TABLE&nbsp;Of&nbsp;BAPISDITMX,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_schd&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;BAPISCHDL,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lt_schd&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;BAPISCHDL,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_schdx&nbsp;&nbsp;&nbsp;TYPE&nbsp;BAPISCHDLX,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lt_schdx&nbsp;&nbsp;&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;BAPISCHDLX,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_cond&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;BAPICOND,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lt_cond&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;BAPICOND,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_condx&nbsp;&nbsp;&nbsp;TYPE&nbsp;BAPICONDX,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lt_condx&nbsp;&nbsp;&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;BAPICONDX.<br />
*<br />
*&nbsp;&nbsp;SORT&nbsp;lt_disp&nbsp;BY&nbsp;req_date&nbsp;ASCENDING.<br />
*&nbsp;&nbsp;CLEAR:&nbsp;gs_disp.<br />
*&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;lt_disp&nbsp;INTO&nbsp;gs_disp&nbsp;GROUP&nbsp;BY&nbsp;(&nbsp;partn_numb&nbsp;=&nbsp;gs_disp-partn_numb&nbsp;purch_no_c&nbsp;=&nbsp;gs_disp-purch_no_c&nbsp;).<br />
*&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:&nbsp;lt_item,&nbsp;lt_schd,&nbsp;lt_cond.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;gt_cp_disp&nbsp;=&nbsp;gt_disp.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;lt_disp&nbsp;INTO&nbsp;ls_disp&nbsp;WHERE&nbsp;partn_numb&nbsp;=&nbsp;gs_disp-partn_numb&nbsp;AND&nbsp;purch_no_c&nbsp;=&nbsp;gs_disp-purch_no_c.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Item&nbsp;setting<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;set_items&nbsp;CHANGING&nbsp;ls_disp&nbsp;ls_item&nbsp;ls_itemx.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item:&nbsp;ITM_NUMBER,&nbsp;MATERIAL,&nbsp;PLANT,&nbsp;TARGET_QTY,&nbsp;TARGET_QU,&nbsp;PURCH_NO_C,&nbsp;INCOTERMS1,&nbsp;PMNTTRMS,&nbsp;SHIP_POINT<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;itemX:&nbsp;UPDATEFLAG,&nbsp;ITM_NUMBER,&nbsp;MATERIAL,&nbsp;PLANT,&nbsp;TARGET_QTY,&nbsp;TARGET_QU,&nbsp;PURCH_NO_C,&nbsp;INCOTERMS1,&nbsp;PMNTTRMS,&nbsp;SHIP_POINT<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ls_item&nbsp;&nbsp;TO&nbsp;lt_item.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ls_itemx&nbsp;TO&nbsp;lt_itemx.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;schedule&nbsp;line&nbsp;setting<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;set_schd&nbsp;USING&nbsp;ls_disp&nbsp;CHANGING&nbsp;ls_schd&nbsp;ls_schdx.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;schd:&nbsp;ITM_NUMBER,&nbsp;SCHED_LINE,&nbsp;REQ_QTY<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;schdx:&nbsp;UPDATEFLAG,&nbsp;ITM_NUMBER,&nbsp;SCHED_LINE,&nbsp;REQ_QTY<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ls_schd&nbsp;&nbsp;TO&nbsp;lt_schd.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ls_schdx&nbsp;TO&nbsp;lt_schdx.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;conditions&nbsp;setting<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;set_cond&nbsp;USING&nbsp;ls_disp&nbsp;CHANGING&nbsp;ls_cond&nbsp;ls_condx.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cond:&nbsp;ITM_NUMBER,&nbsp;COND_TYPE,&nbsp;COND_VALUE,&nbsp;CURRENCY<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;condx:&nbsp;ITM_NUMBER,&nbsp;COND_TYPE,&nbsp;COND_VALUE,&nbsp;CURRENCY<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ls_cond&nbsp;&nbsp;TO&nbsp;lt_cond.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ls_condx&nbsp;TO&nbsp;lt_condx.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;header&nbsp;setting<br />
*&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;set_header&nbsp;USING&nbsp;ls_disp&nbsp;CHANGING&nbsp;ls_header&nbsp;ls_headerx.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;header&nbsp;:&nbsp;doc_type,&nbsp;SALES_ORG,&nbsp;DISTR_CHAN,&nbsp;DIVISION,&nbsp;PURCH_NO_C&nbsp;,&nbsp;PURCH_DATE,&nbsp;INCOTERMS1,&nbsp;PMNTTRMS<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;partner&nbsp;setting<br />
*&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:&nbsp;lt_partner,&nbsp;ls_partner,&nbsp;gs_cust.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;gt_cust&nbsp;INTO&nbsp;gs_cust&nbsp;WITH&nbsp;KEY&nbsp;KUNNR&nbsp;=&nbsp;ls_disp-partn_numb.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;=&nbsp;0.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_partner-PARTN_ROLE&nbsp;=&nbsp;'AG'.&nbsp;"&nbsp;sold-to-party<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_partner-PARTN_NUMB&nbsp;=&nbsp;gs_cust-KUNNR.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_partner-COUNTRY&nbsp;=&nbsp;gs_cust-land1.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_partner-LANGU&nbsp;=&nbsp;gs_cust-spras.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_partner-REGION&nbsp;=&nbsp;&nbsp;gs_cust-regio.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_partner-NAME&nbsp;=&nbsp;gs_cust-name1.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_partner-CITY&nbsp;=&nbsp;gs_cust-ort01.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_partner-POSTL_CODE&nbsp;=&nbsp;gs_cust-pstlz.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ls_partner&nbsp;TO&nbsp;lt_partner.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;ls_partner.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;ls_partner-PARTN_ROLE&nbsp;=&nbsp;'WE'.&nbsp;"&nbsp;ship-to-party<br />
*&nbsp;&nbsp;&nbsp;&nbsp;ls_partner-PARTN_NUMB&nbsp;=&nbsp;'CS01_99999'.&nbsp;"gs_disp-partn_numb.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;ls_partner-COUNTRY&nbsp;=&nbsp;'DE'.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;ls_partner-LANGU&nbsp;=&nbsp;'E'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;gs_partner-REGION&nbsp;=&nbsp;&nbsp;'02'.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;ls_partner-NAME&nbsp;=&nbsp;ls_disp-name.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;ls_partner-CITY&nbsp;=&nbsp;ls_disp-city.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;ls_partner-POSTL_CODE&nbsp;=&nbsp;ls_disp-zipcode.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;ls_partner-STREET&nbsp;=&nbsp;ls_disp-address.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;ls_partner-TELEPHONE&nbsp;=&nbsp;ls_disp-telephone.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ls_partner&nbsp;TO&nbsp;lt_partner.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;create_bapi_salesorder<br />
*&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'BAPI_SALESORDER_CREATEFROMDAT2'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SALESDOCUMENTIN&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;order_header_in&nbsp;&nbsp;=&nbsp;ls_header<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;order_header_inx&nbsp;=&nbsp;ls_headerx<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SENDER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BINARY_RELATIONSHIPTYPE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INT_NUMBER_ASSIGNMENT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BEHAVE_WHEN_ERROR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGIC_SWITCH&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;testrun&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gc_test<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONVERT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'&nbsp;'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;salesdocument&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lv_vbeln<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TABLES<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lt_return<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORDER_ITEMS_IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lt_item<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORDER_ITEMS_INX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lt_itemx<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;order_partners&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lt_partner<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORDER_SCHEDULES_IN&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lt_schd<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORDER_SCHEDULES_INX&nbsp;&nbsp;&nbsp;=&nbsp;lt_schdx<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORDER_CONDITIONS_IN&nbsp;&nbsp;&nbsp;=&nbsp;lt_cond<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORDER_CONDITIONS_INX&nbsp;&nbsp;=&nbsp;lt_condx<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORDER_CFGS_REF&nbsp;&nbsp;&nbsp;=<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORDER_CFGS_INST&nbsp;&nbsp;=<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORDER_CFGS_PART_OF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORDER_CFGS_VALUE&nbsp;=<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORDER_CFGS_BLOB&nbsp;&nbsp;=<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORDER_CFGS_VK&nbsp;&nbsp;&nbsp;&nbsp;=<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORDER_CFGS_REFINST&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORDER_CCARD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORDER_TEXT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORDER_KEYS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXTENSIONIN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARTNERADDRESSES&nbsp;=<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXTENSIONEX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NFMETALLITMS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.<br />
            </div>
          </td>
        </tr>
      </table>
      </td>
      </tr>
   <tr>
<td class="footer">Extracted by Mass Download version 1.5.5 - E.G.Mellodew. 1998-2021. Sap Release 754</td>
   </tr>
</table>
</body>
</html>
